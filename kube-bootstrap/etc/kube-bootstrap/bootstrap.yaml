apiVersion: v1
kind: Pod
metadata:
  name: controller-bootstrap
  namespace: kube-system
  labels:
    app: kubernetes
    component: controller-bootstrap
spec:
  hostNetwork: true
  containers:
    - name: bootstrap
      image: quay.io/roboll/kube-bootstrap:alpha
      imagePullPolicy: Always
      command:
        - /opt/bin/bootstrap.sh
      env:
        - name: HYPERKUBE
          value: ${HYPERKUBE}
        - name: KUBE_FQDN
          value: ${KUBE_FQDN}
        - name: KUBE_CA
          value: /etc/kubernetes/ca.pem
        - name: ETCD_NODES
          value: ${ETCD_NODES}
        - name: ETCD_PEERS
          value: ${ETCD_PEERS}
      volumeMounts:
        - name: env
          mountPath: /etc/kube-bootstrap/env
          readOnly: true
        - name: kube-ca
          mountPath: /etc/kubernetes/ca.pem
          readOnly: true
        - name: manifests
          mountPath: /etc/kubernetes/manifests
          readOnly: true
  volumes:
    - name: env
      hostPath:
        path: /etc/kube-bootstrap/env
    - name: kube-ca
      hostPath:
        path: ${KUBE_CA}
    - name: manifests
      hostPath:
        path: /etc/kubernetes/manifests
